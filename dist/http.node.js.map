{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/@babel/runtime/helpers/defineProperty.js","webpack:///external \"querystring\"","webpack:///./node_modules/@babel/runtime/helpers/objectSpread.js","webpack:///external \"http\"","webpack:///external \"https\"","webpack:///./src/client.js","webpack:///./src/utils.js","webpack:///./src/constants.js","webpack:///./src/middleware/basic_auth_middleware.js","webpack:///./src/middleware/json_body_middleware.js","webpack:///./src/middleware/json_response_middleware.js","webpack:///./src/middleware/response_status_middleware.js","webpack:///./src/adapters/node.js","webpack:///./src/middleware/body_middleware.js","webpack:///./entries/node.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","default","object","property","prototype","hasOwnProperty","p","s","e","obj","configurable","writable","require","target","arguments","length","source","ownKeys","keys","getOwnPropertySymbols","concat","filter","sym","getOwnPropertyDescriptor","forEach","client","adapter","Error","middlewares","request","response","error","del","_len","args","Array","_key","apply","httpClient","_len2","_key2","post","_len6","_key6","put","_len7","_key7","patch","_len5","_key5","head","_len3","_key3","options","_len4","_key4","delete","middleware","chain","callback","push","setup","runMiddleware","reduce","buffer","handleRequestError","reject","BODY","basicAuthMiddleware","string","_options$auth","auth","username","password","headers","authorization","atob","Buffer","from","toString","jsonBodyMiddleware","method","body","contentType","includes","JSON","stringify","params","jsonResponseMiddleware","data","parse","responseStatusMiddleware","status","String","success","match","redirect","location","url","requestHasBody","encode","assign","timeout","objectSpread_default","defineProperty_default","toLowerCase","querystring","uri","URL","protocol","http","https","promise","Promise","resolve","once","responseBody","on","chunk","returnValue","statusCode","aborted","abort","write","end","emit","constructor","FormData","__webpack_exports__","client_client"],"mappings":"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","file":"http.node.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","module.exports = require(\"querystring\");","var defineProperty = require(\"./defineProperty\");\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      defineProperty(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\n\nmodule.exports = _objectSpread;","module.exports = require(\"http\");","module.exports = require(\"https\");","export function client(adapter) {\n  if (!adapter) {\n    throw new Error(\"Adapter is required\");\n  }\n\n  const middlewares = {request: [], response: [], error: []};\n  const del     = (...args) => adapter(\"delete\", middlewares, ...args);\n  const get     = (...args) => adapter(\"get\", middlewares, ...args);\n  const head    = (...args) => adapter(\"head\", middlewares, ...args);\n  const options = (...args) => adapter(\"options\", middlewares, ...args);\n  const patch   = (...args) => adapter(\"patch\", middlewares, ...args);\n  const post    = (...args) => adapter(\"post\", middlewares, ...args);\n  const put     = (...args) => adapter(\"put\", middlewares, ...args);\n\n  const middleware = (chain, callback) => {\n    if (callback) {\n      middlewares[chain].push(callback);\n    }\n\n    return middlewares;\n  };\n\n  const httpClient = {get, post, put, patch, head, options, del, delete: del, middleware};\n\n  adapter.setup(httpClient);\n\n  return httpClient;\n}\n","export function runMiddleware(chain, target) {\n  return chain.reduce((buffer, middleware) => middleware(buffer), target);\n}\n\nexport function normalizeHeaders(headers) {\n  return Object.keys(headers).reduce((buffer, key) => (\n    Object.assign(buffer, {[key.toLowerCase()]: headers[key]})\n  ), {});\n}\n\nexport function handleRequestError(error, middleware, request, reject) {\n  error.request = request;\n  error = runMiddleware(middleware, error);\n  reject(error);\n}\n\nexport function buildUrl(url, params, requestHasBody, encode) {\n  if (!requestHasBody && Object.keys(params).length > 0) {\n    url += url.includes(\"?\") ? \"&\" : \"?\";\n    url += encode(params);\n  }\n\n  return url;\n}\n\nexport function prepareOptions(options) {\n  return Object.assign({headers: {},\n                        auth: {},\n                        body: null,\n                        method: null,\n                        timeout: 0}, options || {});\n}\n","export const BODY = {\n  delete:  {request: false, response: true},\n  get:     {request: false, response: true},\n  head:    {request: false, response: false},\n  options: {request: false, response: true},\n  patch:   {request: true,  response: true},\n  post:    {request: true,  response: true},\n  put:     {request: true,  response: true}\n};\n","function base64(string) {\n  if (typeof atob === \"function\") {\n    return atob(string);\n  } else {\n    return Buffer.from(string).toString(\"base64\");\n  }\n}\n\nexport default function basicAuthMiddleware(options) {\n  let { username, password } = options.auth;\n\n  if (username || password) {\n    options.headers[\"authorization\"] = \"Basic \" + base64(`${username}:${password}`);\n  }\n\n  return options;\n}\n","import { BODY } from \"../constants\";\n\nexport default function jsonBodyMiddleware(options) {\n  if (!BODY[options.method].request) {\n    delete options.body;\n    return options;\n  }\n\n  if (options.body) {\n    return options;\n  }\n\n  const contentType = options.headers[\"content-type\"];\n\n  if (!contentType || !contentType.includes(\"application/json\")) {\n    return options;\n  }\n\n  options.body = JSON.stringify(options.params);\n\n  return options;\n}\n","export default function jsonResponseMiddleware(response) {\n  if (!response.headers[\"content-type\"].includes(\"application/json\")) {\n    return response;\n  }\n\n  try {\n    response.data = JSON.parse(response.body);\n  } catch (error) {\n\n  }\n\n  return response;\n}\n","export default function responseStatusMiddleware(response) {\n  const status = String(response.status);\n\n  response.success = !!(status[0].match(/^[2-3]/));\n  response.redirect = status[0] === \"3\";\n\n  if (response.redirect) {\n    response.location = response.headers.location;\n  }\n\n  return response;\n}\n","import http from \"http\";\nimport https from \"https\";\nimport querystring from \"querystring\";\n\nimport {\n  buildUrl,\n  prepareOptions,\n  handleRequestError,\n  normalizeHeaders,\n  runMiddleware\n} from \"../utils\";\n\nimport {\n  BODY\n} from \"../constants\";\n\nimport basicAuthMiddleware from \"../middleware/basic_auth_middleware\";\nimport bodyMiddleware from \"../middleware/body_middleware\";\nimport jsonBodyMiddleware from \"../middleware/json_body_middleware\";\nimport jsonResponseMiddleware from \"../middleware/json_response_middleware\";\nimport responseStatusMiddleware from \"../middleware/response_status_middleware\";\n\nfunction handleResponse(request, method, middleware, resolve, response) {\n  let responseBody = Buffer.from([]);\n\n  response.on(\"data\", chunk => {\n    responseBody = Buffer.concat([responseBody, Buffer.from(chunk)]);\n  });\n\n  response.on(\"end\", () => {\n    let returnValue = {\n      body: responseBody,\n      status: response.statusCode,\n      request,\n      response,\n      method,\n      headers: response.headers\n    };\n\n    returnValue = runMiddleware(middleware, returnValue);\n\n    resolve(returnValue);\n  });\n}\n\nfunction handleError(request, middleware, reject, error) {\n  handleRequestError(error, middleware, request, reject);\n}\n\nfunction handleTimeout(request, middleware, reject) {\n  const error = new Error(\"Request timed out\");\n  error.timeout = true;\n\n  handleRequestError(error, middleware, request, reject);\n  request.abort();\n}\n\nfunction handleAbort(request, middleware, reject) {\n  const error = new Error(\"Aborted request\");\n  error.aborted = true;\n  handleRequestError(error, middleware, request, reject);\n}\n\nfunction buildRequest(url, method, headers, timeout) {\n  const uri = new URL(url);\n  const engine = uri.protocol === \"http:\" ? http : https;\n\n  const request = engine.request(uri, {\n    method,\n    headers,\n    timeout\n  });\n\n  return request;\n}\n\n/**\n * Perform http requests using [http](https://nodejs.org/api/http.html) and [https](https://nodejs.org/api/https.html).\n *\n * ```js\n * client\n *   .get(\"https://example.com\")\n *   .then((response, request) => console.log(response, request))\n *   .catch(error => console.log(error, error.request, error.aborted));\n * ```\n *\n * @param  {String} method           The HTTP request method.\n * @param  {Object} middlewares      The middleware chain.\n * @param  {String} url              The request url.\n * @param  {Object} params           The request params.\n * @param  {Object} options.auth     An object representing the basic authentication credentials.\n *                                   It must be something like `{username, password}`.\n * @param  {Object} options.headers  The request headers. Header names should be defined in lowercase form.\n * @param  {Object} options.timeout  The request timeout. Default to 0 (never times out).\n * @param  {Object} options.body     The request body. In case you want to specify it manually.\n * @return {Promise}                 A custom response promise that has an additional `.abort()`\n *                                   method that aborts the in-flight request. Aborted requests will\n *                                   reject the promise.\n */\nexport function adapter(method, middlewares, url, params, options) {\n  params = params || {};\n  options = prepareOptions(options);\n\n  options = runMiddleware(middlewares.request, {...options, params, method, url});\n  options.headers = normalizeHeaders(options.headers);\n  options.url = buildUrl(options.url, options.params, BODY[options.method].request, querystring.stringify);\n\n  const request = buildRequest(options.url, options.method, options.headers, options.timeout);\n\n  const promise = new Promise(function(resolve, reject) {\n    request.once(\"response\", handleResponse.bind(null, request, options.method, middlewares.response, resolve));\n    request.once(\"abort\", handleAbort.bind(null, request, middlewares.error, reject));\n    request.on(\"timeout\", handleTimeout.bind(null, request, middlewares.error, reject));\n    request.on(\"error\", handleError.bind(null, request, middlewares.error, reject));\n\n    if (options.body) {\n      request.write(options.body);\n    }\n\n    request.end();\n  });\n\n  promise.abort = () => {\n    request.emit(\"abort\");\n    request.abort();\n  };\n\n  return promise;\n}\n\nadapter.setup = client => {\n  client.middleware(\"request\", basicAuthMiddleware);\n  client.middleware(\"request\", jsonBodyMiddleware); // must be added before bodyMiddleware\n  client.middleware(\"request\", bodyMiddleware.bind(null, querystring.stringify));\n  client.middleware(\"response\", jsonResponseMiddleware);\n  client.middleware(\"response\", responseStatusMiddleware);\n};\n","import { BODY } from \"../constants\";\n\nfunction isFormData(object) {\n  return typeof FormData === \"function\" && object instanceof FormData;\n}\n\nexport default function bodyMiddleware(encode, options) {\n  if (!BODY[options.method].request) {\n    delete options.body;\n    return options;\n  }\n\n  if (options.body) {\n    return options;\n  }\n\n  if (options.params.constructor === Object) {\n    options.body = encode(options.params);\n  } else {\n    options.body = options.params;\n  }\n\n  if (!options.headers[\"content-type\"] && !isFormData(options.body)) {\n    options.headers[\"content-type\"] = \"application/x-www-form-urlencoded\";\n  }\n\n  return options;\n}\n","export { client } from \"../src/client\";\nexport { adapter } from \"../src/adapters/node\";\n"],"sourceRoot":""}